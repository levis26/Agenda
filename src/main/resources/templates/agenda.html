<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Agenda de Espacios</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
</head>
<body>
<div class="container">
    <h1 th:text="'üìÖ Agenda - ' + ${agendaViewModel.mesNombre} + ' ' + ${agendaViewModel.anyo}"></h1>

    <!-- Iterar por cada sala -->
    <div th:each="salaEntry : ${agendaViewModel.agendaPorSala}">
        <h2 th:text="${salaEntry.key}"></h2> <!-- Nombre de la sala -->
        
        <!-- Tabla por semana -->
        <table class="agenda-table" th:each="semana : ${agendaViewModel.semanas}">
            <thead>
                <tr>
                    <th>Horario</th>
                    <th th:each="diaSemana : ${semana}" 
                        th:text="${agendaViewModel.traducirDia(agendaViewModel.getDiasSemana().get(diaSemana.getDayOfWeek().getValue() - 1))}">
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- Iterar por cada horario √∫nico -->
                <tr th:each="horario : ${agendaViewModel.horariosUnicos}">
                    <td th:text="${horario}"></td> <!-- Horario -->
                    
                    <!-- Celda por d√≠a de la semana -->
                    <td th:each="dia : ${semana}" 
                        th:classappend="${agendaViewModel.getEstado(salaEntry.key, dia, horario)}" 
                        th:text="${agendaViewModel.agendaPorSala.get(salaEntry.key).get(dia)?.get(horario)}">
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Secci√≥n de incidencias -->
    <div th:if="${not agendaViewModel.incidencias.isEmpty()}" class="incidencias">
        <h3>‚ö†Ô∏è Incidencias Detectadas</h3>
        <ul>
            <li th:each="incidencia : ${agendaViewModel.incidencias}"
                th:text="${incidencia}"></li>
        </ul>
    </div>
</div>
</body>
</html>