<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Agenda de Espacios</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
</head>
<body>
<div class="container">
    <h1 th:text="'üìÖ Agenda - ' + ${agendaViewModel.mesNombre} + ' ' + ${agendaViewModel.anyo}"></h1>

    <div th:if="${error}" class="incidencias error-message">
        <p th:text="${error}"></p>
    </div>

    <div th:each="salaName : ${agendaViewModel.getAgendaPorSala().keySet()}" class="sala-section">
        <h2 th:text="${salaName}"></h2> <div th:each="semana : ${agendaViewModel.getSemanas()}" class="week-section">
        <h3>Semana del <span th:text="${#temporals.format(semana.get(0), 'dd/MM/yyyy')}"></span></h3>

        <table>
            <thead>
            <tr>
                <th>Hora</th> <th th:each="dia : ${semana}"
                                  th:class="${dia.getMonth() != agendaViewModel.getMesProcesar().getMonth() ? 'dia-fuera-mes' : ''}">
                <span th:text="${dia.getDayOfMonth()}"></span><br/>
                <span th:text="${agendaViewModel.getDiaInicialTraducido(dia)}"></span>
            </th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="horario : ${agendaViewModel.getHorariosUnicos()}">
                <td th:text="${horario}"></td> <td th:each="dia : ${semana}">
                <div th:with="actividad=${agendaViewModel.getActividadEnCelda(salaName, dia, horario)}"
                     th:class="${actividad == 'Tancat' ? 'celda-tancada' : (actividad != null ? 'celda-ocupada' : 'celda-libre')}">
                    <span th:text="${actividad != null ? actividad : ''}"></span>
                </div>
            </td>
            </tr>
            </tbody>
        </table>
        <hr/> </div>
        <hr/> </div>

    <div th:if="${not agendaViewModel.incidencias.isEmpty()}" class="incidencias">
        <h3>‚ö†Ô∏è Incidencias Detectadas</h3>
        <ul>
            <li th:each="incidencia : ${agendaViewModel.incidencias}"
                th:text="${incidencia}"></li>
        </ul>
    </div>

</div>
</body>
</html>